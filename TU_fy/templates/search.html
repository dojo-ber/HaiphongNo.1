{% extends "base.html" %} {% block content %}
<div class="container mt-4">
  <h1 class="mb-4 text-info">üéµ Songtext-Suche</h1>

  <form method="post" class="mb-4">
    {% csrf_token %}
    <div class="input-group">
      <input
        type="text"
        name="query"
        class="form-control bg-dark text-light"
        placeholder="K√ºnstler oder Song eingeben..."
        required
      />
      <button type="submit" class="btn btn-primary">
        <i class="bi bi-search"></i> Suchen
      </button>
    </div>
  </form>

  {% if messages %}
  <div class="mb-4">
    {% for message in messages %}
    <div class="alert alert-{{ message.tags }} alert-dismissible fade show">
      {{ message }}
      <button
        type="button"
        class="btn-close"
        data-bs-dismiss="alert"
        aria-label="Close"
      ></button>
    </div>
    {% endfor %}
  </div>
  {% endif %} {% if error %}
  <div class="alert alert-danger">{{ error }}</div>
  {% endif %} {% if results %}
  <div class="card bg-dark border-secondary">
    <div class="card-header bg-secondary text-white">
      <h5 class="mb-0">Suchergebnisse</h5>
    </div>
    <ul class="list-group list-group-flush">
      {% for result in results %}
      <li
        class="list-group-item d-flex justify-content-between align-items-center py-2 bg-dark text-light"
      >
        <div class="text-truncate">
          <span class="fw-bold text-info">{{ result.artist.name }}</span>
          <span class="text-muted">‚Äì</span>
          <span>{{ result.title }}</span>
        </div>

        <div class="btn-group">
          <!-- Zur Playlist hinzuf√ºgen Button -->
          <form
            action="{% url 'add_to_playlist' %}"
            method="post"
            class="d-inline ms-1"
          >
            {% csrf_token %}
            <input type="hidden" name="title" value="{{ result.title }}" />
            <input
              type="hidden"
              name="artist"
              value="{{ result.artist.name }}"
            />
            <button
              type="submit"
              class="btn btn-sm btn-outline-success"
              title="Zur Playlist hinzuf√ºgen"
            >
              <i class="bi bi-plus-circle"></i> Playlist
            </button>
          </form>
          <form action="{% url 'toggle_like' %}" method="post" class="d-inline">
            {% csrf_token %}
            <input
              type="hidden"
              name="artist"
              value="{{ result.artist.name }}"
            />
            <input type="hidden" name="title" value="{{ result.title }}" />
            <button
              type="submit"
              class="btn btn-sm {% if result.liked %}btn-danger{% else %}btn-outline-danger{% endif %}"
              title="Zu Favoriten hinzuf√ºgen oder entfernen"
            >
              <i
                class="bi {% if result.liked %}bi-heart-fill{% else %}bi-heart{% endif %}"
              ></i>
            </button>
          </form>

          <!-- Songtext Button -->
          <form action="{% url 'index' %}" method="post" class="d-inline ms-1">
            {% csrf_token %}
            <input
              type="hidden"
              name="artist"
              value="{{ result.artist.name }}"
            />
            <input type="hidden" name="title" value="{{ result.title }}" />
            <button
              type="submit"
              class="btn btn-sm btn-outline-info"
              title="Songtext analysieren"
            >
              <i class="bi bi-music-note-beamed"></i> Lyrics
            </button>
          </form>
        </div>
      </li>
      {% endfor %}
    </ul>
  </div>
  {% endif %}
  <div class="text-center mt-4">
    <a href="{% url 'overview_playlist' %}" class="btn btn-outline-light">
      Playlist-√úbersicht
    </a>
    <a href="{% url 'dashboard' %}" class="btn btn-outline-light">
      ‚Üê Zur√ºck zum Dashboard
    </a>
  </div>
</div>
{% endblock %}
